#include <string.h>
#include "map.h"

// --- 2×2 방 데이터 배열들 ---
int g_room00[MAP_HEIGHT][MAP_WIDTH] =
{
    // Row 0: 천장
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
    // Row 1: 천장 바로 아래
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
    
    // Row 2: ★ 여기에 3번(거꾸로 가시) 배치 테스트!
    {1,0,0,0,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0,0,0,1},

    // Row 3~19 (나머지는 0 또는 기존 맵 유지)
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0}, // Goal
    {1,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,1,0,0,0,0,1}, // 바닥 가시
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1},
    {1,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1}, // Start
    {1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1},
    {1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1},
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1}, // 바닥
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
};
int g_room01[MAP_HEIGHT][MAP_WIDTH] =
{
    // Row 0: 천장
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},

    // Row 1
    {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},

    // Row 2: 00방의 Row2와 높이 연결 → 중앙 길을 계속 유지
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 3
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 4
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 5: 중간 플랫폼
    {0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,1},

    // Row 6
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 7: 위쪽 가시
    {1,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,1},

    // Row 8
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 9
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row10: 출구 플랫폼 (아래 방으로 연결 가능하게 열어둠)
    {1,2,2,2,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,1},

    // Row11~18: 빈 공간
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
    {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},

    // Row 19: 바닥
    {1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1}
};
int g_room10[MAP_HEIGHT][MAP_WIDTH] = { /* 세 번째 방 */ };
int g_room11[MAP_HEIGHT][MAP_WIDTH] = { /* 네 번째 방 */ };

// 현재 방
int g_map_data[MAP_HEIGHT][MAP_WIDTH];

int current_room_row = 0;
int current_room_col = 0;


// --------------------------------------------------------------------
// 방 불러오기
// --------------------------------------------------------------------
void LoadRoom(int row, int col)
{
    if (row == 0 && col == 0)
        memcpy(g_map_data, g_room00, sizeof(g_map_data));
    else if (row == 0 && col == 1)
        memcpy(g_map_data, g_room01, sizeof(g_map_data));
    else if (row == 1 && col == 0)
        memcpy(g_map_data, g_room10, sizeof(g_map_data));
    else if (row == 1 && col == 1)
        memcpy(g_map_data, g_room11, sizeof(g_map_data));

    current_room_row = row;
    current_room_col = col;
}


// --------------------------------------------------------------------
// drow, dcol 만큼 방을 이동시킴
// --------------------------------------------------------------------
void ChangeRoom(int drow, int dcol)
{
    int new_r = current_room_row + drow;
    int new_c = current_room_col + dcol;

    // 방 범위 체크
    if (new_r < 0 || new_r >= ROOM_ROWS) return;
    if (new_c < 0 || new_c >= ROOM_COLS) return;

    LoadRoom(new_r, new_c);
}
